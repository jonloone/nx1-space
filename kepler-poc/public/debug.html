<!DOCTYPE html>
<html>
<head>
    <title>Debug - Ground Station Data</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        pre { background: #f4f4f4; padding: 10px; overflow: auto; }
    </style>
</head>
<body>
    <h1>üîç Ground Station Data Debug</h1>
    <div id="status"></div>
    <div id="results"></div>

    <script>
        const status = document.getElementById('status');
        const results = document.getElementById('results');

        function addStatus(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            status.appendChild(div);
        }

        function addResult(title, content) {
            const div = document.createElement('div');
            div.innerHTML = `<h3>${title}</h3><pre>${JSON.stringify(content, null, 2)}</pre>`;
            results.appendChild(div);
        }

        // Test 1: Check if we can reach the server
        addStatus('Testing server connection...', 'info');
        
        // Test 2: Try to load the data file
        fetch('/data/kepler_ground_stations.json')
            .then(response => {
                addStatus(`Data fetch response: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return response.json();
            })
            .then(data => {
                addStatus('‚úÖ Data loaded successfully!', 'success');
                
                // Show data summary
                addResult('Data Structure', {
                    version: data.version,
                    dataId: data.data?.id,
                    dataLabel: data.data?.label,
                    recordCount: data.data?.allData?.length || 0,
                    hasConfig: !!data.config
                });
                
                // Show first record
                if (data.data?.allData?.length > 0) {
                    addResult('First Station', data.data.allData[0]);
                }
                
                // Show config summary
                if (data.config) {
                    addResult('Config Summary', {
                        hasVisState: !!data.config.config?.visState,
                        hasMapState: !!data.config.config?.mapState,
                        hasMapStyle: !!data.config.config?.mapStyle,
                        layerCount: data.config.config?.visState?.layers?.length || 0
                    });
                }
            })
            .catch(error => {
                addStatus(`‚ùå Error: ${error.message}`, 'error');
                console.error('Full error:', error);
            });

        // Test 3: Check Kepler.gl dependencies
        setTimeout(() => {
            addStatus('Checking Kepler.gl dependencies...', 'info');
            
            const deps = {
                React: typeof React !== 'undefined',
                ReactDOM: typeof ReactDOM !== 'undefined',
                Redux: typeof Redux !== 'undefined',
                ReactRedux: typeof ReactRedux !== 'undefined',
                KeplerGl: typeof KeplerGl !== 'undefined',
                styled: typeof styled !== 'undefined'
            };
            
            let allLoaded = true;
            for (const [dep, loaded] of Object.entries(deps)) {
                if (!loaded) {
                    addStatus(`‚ùå ${dep} not loaded`, 'error');
                    allLoaded = false;
                }
            }
            
            if (allLoaded) {
                addStatus('‚úÖ All Kepler.gl dependencies loaded', 'success');
            }
            
            addResult('Dependency Status', deps);
        }, 2000);
    </script>
</body>
</html>